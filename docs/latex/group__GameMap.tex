\hypertarget{group__GameMap}{}\section{Game\+Map}
\label{group__GameMap}\index{GameMap@{GameMap}}


Map creation and query routines.  


\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structTTile}{T\+Tile}}
\begin{DoxyCompactList}\small\item\em Single tile information. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structTMap}{T\+Map}}
\begin{DoxyCompactList}\small\item\em Map dimensions and tiles it contains. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structTRoom}{T\+Room}}
\begin{DoxyCompactList}\small\item\em Rooms in the level. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structTGridCell}{T\+Grid\+Cell}}
\begin{DoxyCompactList}\small\item\em Grid cell info, used to distribute the rooms. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group__GameMap_ga0a25d4a00a01f6a01f415c8cf22b17d2}{Map\+Create}} (u8 width, u8 height, \mbox{\hyperlink{structTEntity}{T\+Entity}} $\ast$player)
\begin{DoxyCompactList}\small\item\em Create a new map. \end{DoxyCompactList}\item 
u8 \mbox{\hyperlink{group__GameMap_ga3eae0d3c0cf7368023838ed2dfc5e3c8}{Map\+Is\+Blocked}} (u8 x, u8 y)
\begin{DoxyCompactList}\small\item\em True if specified map coordinates block movement (i.\+e\+: wall) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga4a96cfd7d7f5dab759c0274d498ca927}\label{group__GameMap_ga4a96cfd7d7f5dab759c0274d498ca927}} 
u8 \mbox{\hyperlink{group__GameMap_ga4a96cfd7d7f5dab759c0274d498ca927}{Map\+Blocks\+Light}} (u8 x, u8 y)
\begin{DoxyCompactList}\small\item\em True if specified map coordinates block light (i.\+e\+: wall) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga806e9ea5321e82e566b161fcbd5e2e2d}\label{group__GameMap_ga806e9ea5321e82e566b161fcbd5e2e2d}} 
void \mbox{\hyperlink{group__GameMap_ga806e9ea5321e82e566b161fcbd5e2e2d}{Map\+Set\+Not\+Visible}} (u8 origin\+\_\+x, u8 origin\+\_\+y, u8 range)
\begin{DoxyCompactList}\small\item\em Sets area around origin\+\_\+x/\+\_\+y to not visible. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__GameMap_ga300f688f7b1989dba73d6bae2772a7dc}{Map\+Draw}} (u8 left, u8 right, u8 width, u8 height, \mbox{\hyperlink{structTEntity}{T\+Entity}} $\ast$player)
\begin{DoxyCompactList}\small\item\em Draws a visible portion of the map centered around the player. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_gae17467d65d599928e1b7bfa3ddeee49f}\label{group__GameMap_gae17467d65d599928e1b7bfa3ddeee49f}} 
void {\bfseries Get\+View} (\mbox{\hyperlink{structTEntity}{T\+Entity}} $\ast$player, u8 $\ast$left, u8 $\ast$top, u8 width, u8 height)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__GameMap_ga4e29a9a98bfa352440b628a995cba64d}\label{group__GameMap_ga4e29a9a98bfa352440b628a995cba64d}} 
u8 \mbox{\hyperlink{group__GameMap_ga4e29a9a98bfa352440b628a995cba64d}{T\+Tile\+::t\+\_\+flags}}
\begin{DoxyCompactList}\small\item\em flag attributes for a specific tile \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga2fe3dde5db57e2ec58a78ceb85ef1642}\label{group__GameMap_ga2fe3dde5db57e2ec58a78ceb85ef1642}} 
u8 \mbox{\hyperlink{group__GameMap_ga2fe3dde5db57e2ec58a78ceb85ef1642}{T\+Map\+::width}}
\begin{DoxyCompactList}\small\item\em Game map width. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga62f0d660273fafe5b4f27ecc7f95456d}\label{group__GameMap_ga62f0d660273fafe5b4f27ecc7f95456d}} 
u8 \mbox{\hyperlink{group__GameMap_ga62f0d660273fafe5b4f27ecc7f95456d}{T\+Map\+::height}}
\begin{DoxyCompactList}\small\item\em Game map height. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_gac8050f8f059101f93288d8f4037531c9}\label{group__GameMap_gac8050f8f059101f93288d8f4037531c9}} 
\mbox{\hyperlink{structTTile}{T\+Tile}} \mbox{\hyperlink{group__GameMap_gac8050f8f059101f93288d8f4037531c9}{T\+Map\+::tiles}} \mbox{[}M\+A\+P\+\_\+\+H\+E\+I\+G\+HT\mbox{]}\mbox{[}M\+A\+P\+\_\+\+W\+I\+D\+TH\mbox{]}
\begin{DoxyCompactList}\small\item\em every single tile in the map \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga637db7778f278eaa8fd09ec009881ae2}\label{group__GameMap_ga637db7778f278eaa8fd09ec009881ae2}} 
\mbox{\hyperlink{structTRect}{T\+Rect}} \mbox{\hyperlink{group__GameMap_ga637db7778f278eaa8fd09ec009881ae2}{T\+Room\+::rect}}
\begin{DoxyCompactList}\small\item\em x,y, width, height including walls \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_gaf547d9aae28ee0d3a09d51cb4650659c}\label{group__GameMap_gaf547d9aae28ee0d3a09d51cb4650659c}} 
u8 \mbox{\hyperlink{group__GameMap_gaf547d9aae28ee0d3a09d51cb4650659c}{T\+Room\+::grid\+\_\+id}}
\begin{DoxyCompactList}\small\item\em Grid id where the room is placed. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga9eb413b36d66119ffbb32a5a23c5d628}\label{group__GameMap_ga9eb413b36d66119ffbb32a5a23c5d628}} 
u8 \mbox{\hyperlink{group__GameMap_ga9eb413b36d66119ffbb32a5a23c5d628}{T\+Grid\+Cell\+::x}}
\begin{DoxyCompactList}\small\item\em left coordinate of the grid cell \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga203679fb4506b253419a1eb4db418ae5}\label{group__GameMap_ga203679fb4506b253419a1eb4db418ae5}} 
u8 \mbox{\hyperlink{group__GameMap_ga203679fb4506b253419a1eb4db418ae5}{T\+Grid\+Cell\+::y}}
\begin{DoxyCompactList}\small\item\em top coordinate of the grid cell \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_gaf6810a8c1ba4361c7fda884f6cbb7787}\label{group__GameMap_gaf6810a8c1ba4361c7fda884f6cbb7787}} 
u8 \mbox{\hyperlink{group__GameMap_gaf6810a8c1ba4361c7fda884f6cbb7787}{T\+Grid\+Cell\+::room\+\_\+id}}
\begin{DoxyCompactList}\small\item\em room assigned to this grid cell \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga86fd67ae05bb10aa49151b5cbcfb03ad}\label{group__GameMap_ga86fd67ae05bb10aa49151b5cbcfb03ad}} 
\mbox{\hyperlink{structTGridCell}{T\+Grid\+Cell}} \mbox{\hyperlink{group__GameMap_ga86fd67ae05bb10aa49151b5cbcfb03ad}{grid}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em Grid cells. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__GameMap_ga0b54f3c216fb05da0dd0c07c9140cfb6}\label{group__GameMap_ga0b54f3c216fb05da0dd0c07c9140cfb6}} 
\mbox{\hyperlink{structTRoom}{T\+Room}} \mbox{\hyperlink{group__GameMap_ga0b54f3c216fb05da0dd0c07c9140cfb6}{rooms}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em Rooms placed in map. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structTMap}{T\+Map}} \mbox{\hyperlink{group__GameMap_ga6c049bed6e4286fab8db7b65f4d8f871}{game\+\_\+map}}
\begin{DoxyCompactList}\small\item\em Global variable to access the game map. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The structures and functions in this module helps with the creation and query of the map in the game.

The game stores information of each tile in the map. Each tile needs to keep track of certain attributes like is it walkable?, or blocks light? etc. 

\subsection{Function Documentation}
\mbox{\Hypertarget{group__GameMap_ga0a25d4a00a01f6a01f415c8cf22b17d2}\label{group__GameMap_ga0a25d4a00a01f6a01f415c8cf22b17d2}} 
\index{GameMap@{GameMap}!MapCreate@{MapCreate}}
\index{MapCreate@{MapCreate}!GameMap@{GameMap}}
\subsubsection{\texorpdfstring{MapCreate()}{MapCreate()}}
{\footnotesize\ttfamily void Map\+Create (\begin{DoxyParamCaption}\item[{u8}]{width,  }\item[{u8}]{height,  }\item[{\mbox{\hyperlink{structTEntity}{T\+Entity}} $\ast$}]{player }\end{DoxyParamCaption})}

Creates a new dungeon of given dimensions and places the player on it. Dungeons bigger than the displayable area are allowed. The dungeon is randomly created by following these steps\+:
\begin{DoxyItemize}
\item Fill the whole map with walls
\item Create a bunch of rooms
\item Distribute the rooms on a grid based pattern
\item Connect the rooms
\end{DoxyItemize}

The player is placed at the first room.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em width} & Width of the map \\
\hline
\mbox{\texttt{ in}}  & {\em height} & Height of the map \\
\hline
\mbox{\texttt{ out}}  & {\em player} & Player to place in the map \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__GameMap_ga300f688f7b1989dba73d6bae2772a7dc}\label{group__GameMap_ga300f688f7b1989dba73d6bae2772a7dc}} 
\index{GameMap@{GameMap}!MapDraw@{MapDraw}}
\index{MapDraw@{MapDraw}!GameMap@{GameMap}}
\subsubsection{\texorpdfstring{MapDraw()}{MapDraw()}}
{\footnotesize\ttfamily void Map\+Draw (\begin{DoxyParamCaption}\item[{u8}]{left,  }\item[{u8}]{top,  }\item[{u8}]{width,  }\item[{u8}]{height,  }\item[{\mbox{\hyperlink{structTEntity}{T\+Entity}} $\ast$}]{player }\end{DoxyParamCaption})}

Draws a portion of the map into the viewport. The start coordinates of the subregion in the map to draw are given by {\itshape left} and {\itshape top} parameters.

Not explored areas are ignored, and thus show as black areas as expected. Explored areas visible by the player are drawn as lighted tiles whereas not visible are drawn darker.

Drawing the full viewport is too slow to the Amstrad C\+PC, so only a small area around the player is drawn. Right now, this area is hardcoded as {\bfseries{F\+O\+V\+\_\+\+R\+A\+D\+I\+US}} +1. {\bfseries{T\+O\+DO\+:}} pass the area to be drawn as parameters {\itshape width} and {\itshape height}.


\begin{DoxyParams}{Parameters}
{\em left} & left tile coordinate from the game map to draw \\
\hline
{\em top} & top map coordinates from the game map to draw \\
\hline
{\em player} & Player entity \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__GameMap_ga3eae0d3c0cf7368023838ed2dfc5e3c8}\label{group__GameMap_ga3eae0d3c0cf7368023838ed2dfc5e3c8}} 
\index{GameMap@{GameMap}!MapIsBlocked@{MapIsBlocked}}
\index{MapIsBlocked@{MapIsBlocked}!GameMap@{GameMap}}
\subsubsection{\texorpdfstring{MapIsBlocked()}{MapIsBlocked()}}
{\footnotesize\ttfamily u8 Map\+Is\+Blocked (\begin{DoxyParamCaption}\item[{u8}]{x,  }\item[{u8}]{y }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x,y} & Map coordinates to query.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if tile blocks movement. 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{group__GameMap_ga6c049bed6e4286fab8db7b65f4d8f871}\label{group__GameMap_ga6c049bed6e4286fab8db7b65f4d8f871}} 
\index{GameMap@{GameMap}!game\_map@{game\_map}}
\index{game\_map@{game\_map}!GameMap@{GameMap}}
\subsubsection{\texorpdfstring{game\_map}{game\_map}}
{\footnotesize\ttfamily \mbox{\hyperlink{structTMap}{T\+Map}} game\+\_\+map}

The global variable {\bfseries{game\+\_\+map}} holds information about the tiles in the current generated map. It\textquotesingle{}s a global variable and can be accessed from any file to query information about a specific tile or dimensions of the map. 